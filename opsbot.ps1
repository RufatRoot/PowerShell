-NoProfile -NoLogo -NonInteractive -Command "add-type \""using System.Net; using System.Security.Cryptography.X509Certificates; public class TrustAllCertsPolicy : ICertificatePolicy {public bool CheckValidationResult(ServicePoint srvPoint, X509Certificate certificate,WebRequest request, int certificateProblem) {return true;}}\""; [System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy; [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Ssl3, [Net.SecurityProtocolType]::Tls, [Net.SecurityProtocolType]::Tls11, [Net.SecurityProtocolType]::Tls12;$AlertName = \""$Data[Default='Not Present']/Context/DataItem/AlertName$\"";$AlertResolutionState = \""$Data[Default='Not Present']/Context/DataItem/ResolutionStateName$\"";$AlertTime = \""$Data[Default='Not Present']/Context/DataItem/TimeRaisedLocal$\"";$AlertDescription = \""$Data[Default='Not Present']/Context/DataItem/AlertDescription$\"";$AlertSource = \""$Data[Default='Not Present']/Context/DataItem/ManagedEntityPath$\$Data[Default='Not Present']/Context/DataItem/ManagedEntityDisplayName$\"";$chatid = \""-100_YOUR_CHANNEL_ID\"";$Message = $AlertName + \""`n\"" + \""`n\"" + \""Status: \"" + $AlertResolutionState + \""`n\"" + \""Alert Time: \"" + $AlertTime + \""`n\"" + \""`n\"" + $AlertDescription + \""`n\"" + \""`n\"" + $AlertSource;$payload = @{ \""parse_mode\"" = \""Markdown\""; \""disable_web_page_preview\"" = \""True\"" };$token = \""YOUR_BOT_TOKEN\"";Invoke-WebRequest -Uri \""https://api.telegram.org/bot$token/sendMessage?chat_id=$chatid&amp;text=$Message\"" -Method Post -ContentType \""application/json; charset=utf-8\"" -Body (ConvertTo-Json -Compress -InputObject $payload)"
